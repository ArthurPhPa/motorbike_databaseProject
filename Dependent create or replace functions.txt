create function fn_get_all_owned_motorbikes(o_id integer) returns SETOF motorbikes
    language plpgsql
as
$$
DECLARE
    v_usr owners;
BEGIN

    SELECT *
    INTO v_usr
    FROM owners as o
    WHERE o.user_id = o_id;

IF o_id ISNULL THEN
        RAISE EXCEPTION 'Access Denied: User % is not an owner.', o_id;
    END IF;

    RETURN QUERY
    SELECT *
    FROM motorbikes as m
    WHERE m.owner_id = o_id
    ORDER BY status;

end;
$$;

create function fn_get_user_by_id(u_id INT) returns users
    language plpgsql
as
$$

BEGIN
    SELECT *
    FROM users
    where users.id = u_id
    LIMIT 1;
end;
$$;

create function fn_get_motorbike_by_licence(m_licence VARCHAR) returns motorbikes
    language plpgsql
as
$$

BEGIN
    SELECT *
    FROM motorbikes
    where license = m_licence
    LIMIT 1;
end;
$$;

















